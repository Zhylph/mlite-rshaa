<div id="form">
  <div class="col-md-6">
    <div class="panel panel-default">
      <div class="panel-body">
        <div class="form-horizontal">
          <div class="form-group">
            <label for="" class="col-sm-3 control-label">Tanggal Masuk</label>
            <div class="col-sm-4">
              <input type="text" id="tgl_masuk" name="tgl_masuk" class="form-control tanggal" value="{$rawat_inap.kamar_inap.tgl_masuk}">
            </div>
            <label for="" class="col-sm-2 control-label">Jam</label>
            <div class="col-sm-3">
              <input type="text" id="jam_masuk" name="jam_masuk" class="form-control jam" value="{$rawat_inap.kamar_inap.jam_masuk}">
            </div>
          </div>
          <div class="form-group" id="tanggal_keluar">
            <label for="" class="col-sm-3 control-label">Tanggal Keluar</label>
            <div class="col-sm-4">
              <input type="text" id="tgl_keluar" name="tgl_keluar" class="form-control tanggal" value="{$rawat_inap.kamar_inap.tgl_keluar}">
            </div>
            <label for="" class="col-sm-2 control-label">Jam</label>
            <div class="col-sm-3">
              <input type="text" id="jam_keluar" name="jam_keluar" class="form-control jam" value="{$rawat_inap.kamar_inap.jam_keluar}">
            </div>
          </div>
          <div class="form-group" id="cari_pasien">
            <label for="pasien" class="col-sm-3 control-label">Pasien</label>
            <div class="col-sm-9">
              <input type="text" name="pasien" class="form-control" placeholder="Cari nama pasien/nomor rekam medik/nomor rawat" value="">
            </div>
          </div>
          <div class="form-group">
            <label for="" class="col-sm-3 control-label">Kamar</label>
            <div class="col-sm-5">
              <select class="form-control" name="kd_kamar">
                {loop: $rawat_inap.kamar}
                <option value="{$value.kd_kamar}"{if: $rawat_inap.kamar_inap.kd_kamar == $value.kd_kamar} selected{/if}>{$value.nm_bangsal} - {$value.kd_kamar}</option>
                {/loop}
              </select>
            </div>
            <label for="" class="col-sm-2 control-label">Lama</label>
            <div class="col-sm-2">
              <input type="text" name="lama" class="form-control" value="{$rawat_inap.kamar_inap.lama}">
            </div>
          </div>
          <div class="form-group">
            <label for="id_dokter" class="col-sm-3 control-label">Dokter</label>
            <div class="col-sm-9">
              <select class="form-control" name="kd_dokter">
                {loop: $rawat_inap.dokter}
                <option value="{$value.kd_dokter}"{if: $rawat_inap.kamar_inap.kd_dokter == $value.kd_dokter} selected{/if}>{$value.nm_dokter}</option>
                {/loop}
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="id_penjamin" class="col-sm-3 control-label">Penjamin</label>
            <div class="col-sm-9">
              <select class="form-control" name="kd_pj">
                {loop: $rawat_inap.penjab}
                <option value="{$value.kd_pj}"{if: $rawat_inap.kamar_inap.kd_pj == $value.kd_pj} selected{/if}>{$value.png_jawab}</option>
                {/loop}
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div id="pasien">
    </div>
    <div class="panel panel-default">
      <div class="panel-body">
        <div class="form-horizontal">
          <div class="form-group">
            <label for="no_rkm_medis" class="col-sm-3 control-label">Nomor RM</label>
            <div class="col-sm-9">
              <input type="text" name="no_rkm_medis" class="form-control" placeholder="Nomor rekam medik" value="{$rawat_inap.kamar_inap.no_rkm_medis}" readonly>
            </div>
          </div>
          <div class="form-group">
            <label for="nama_pasien" class="col-sm-3 control-label">Nama Pasien</label>
            <div class="col-sm-9">
              <input type="text" name="nm_pasien" class="form-control" placeholder="Nama pasien" value="{$rawat_inap.kamar_inap.nm_pasien}" readonly>
            </div>
          </div>
          <div class="form-group">
            <label for="no_rkm_medis" class="col-sm-3 control-label">Nomor Rawat</label>
            <div class="col-sm-9">
              <input type="text" name="no_rawat" class="form-control" value="{$rawat_inap.kamar_inap.no_rawat}" readonly>
            </div>
          </div>
          <div class="form-group" id="diagnosa_masuk">
            <label for="nama_pasien" class="col-sm-3 control-label">Diagnosa Masuk</label>
            <div class="col-sm-9">
              <input type="text" name="diagnosa_awal" class="form-control" placeholder="Diagnosa awal" value="{$rawat_inap.kamar_inap.diagnosa_awal}">
            </div>
          </div>
          <div  id="diagnosa_keluar">
            <div class="form-group">
              <label for="nama_pasien" class="col-sm-3 control-label">Diagnosa Keluar</label>
              <div class="col-sm-9">
                <input type="text" name="diagnosa_akhir" class="form-control" placeholder="Diagnosa akhir" value="{$rawat_inap.kamar_inap.diagnosa_akhir}">
              </div>
            </div>
            <div class="form-group">
              <label for="id_dokter" class="col-sm-3 control-label">Status Keluar</label>
              <div class="col-sm-9">
                <select class="form-control" name="stts_pulang">
                  {loop: $rawat_inap.stts_pulang}
                  <option value="{$value}"{if: $rawat_inap.kamar_inap.stts_pulang == $value} selected{/if}>{$value}</option>
                  {/loop}
                </select>
              </div>
            </div>
          </div>
          <div id="stts_daftar"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-12 m-b-xl">
    <div class="text-center">
      <button type="button" name="button" class="btn btn-primary" id="simpan"><i class="fa fa-save"></i><span class="hidden-xs"> Simpan</span></button>
      <button type="button" name="button" class="btn btn-info" id="simpan_keluar"><i class="fa fa-trash"></i><span class="hidden-xs"> Keluar</span></button>
      <button type="button" name="button" class="btn btn-danger" id="hapus"><i class="fa fa-trash"></i><span class="hidden-xs"> Hapus</span></button>
      <button type="button" name="button" class="btn btn-warning" id="batal"><i class="fa fa-close"></i><span class="hidden-xs"> Batal</span></button>
      <button type="button" name="button" class="btn btn-warning" id="btn_pulangkan_pasien"><i class="fa fa-sign-out"></i><span class="hidden-xs"> Pulangkan Pasien</span></button>
    </div>
  </div>
</div>
<!-- Modal Pulangkan Pasien -->
<div class="modal fade" id="modalPulangkanPasien" tabindex="-1" role="dialog" aria-labelledby="modalPulangkanPasienLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="modalPulangkanPasienLabel">Update Tanggal Pulang SEP</h4>
      </div>
      <div class="modal-body">
        <form id="formPulangkanPasien">
          <div class="form-group">
            <label for="inputNoSep">Nomor SEP</label>
            <input type="text" class="form-control" id="inputNoSep" name="no_sep" placeholder="Nomor SEP" required>
          </div>
          <div class="form-group">
            <label for="inputStatusPulang">Status Pulang</label>
            <select class="form-control" id="inputStatusPulang" name="status_pulang" required>
              <option value="">Pilih Status Pulang</option>
              <option value="1">Atas Persetujuan Dokter</option>
              <option value="3">Atas Permintaan Sendiri</option>
              <option value="4">Meninggal</option>
              <option value="5">Lain-lain</option>
            </select>
          </div>
          <div class="form-group" id="divMeninggal" style="display:none;">
            <label for="inputNoSuratMeninggal">No. Surat Meninggal</label>
            <input type="text" class="form-control" id="inputNoSuratMeninggal" name="no_surat_meninggal" placeholder="No. Surat Meninggal">
          </div>
          <div class="form-group" id="divTglMeninggal" style="display:none;">
            <label for="inputTglMeninggal">Tanggal Meninggal (yyyy-MM-dd)</label>
            <input type="text" class="form-control tanggal" id="inputTglMeninggal" name="tgl_meninggal" placeholder="2024-07-01">
          </div>
          <div class="form-group">
            <label for="inputTglPulang">Tanggal Pulang (yyyy-MM-dd)</label>
            <input type="text" class="form-control tanggal" id="inputTglPulang" name="tgl_pulang" placeholder="2024-07-01" required>
          </div>
          <div class="form-group">
            <label for="inputNoLPManual">No. LP Manual (untuk KLL)</label>
            <input type="text" class="form-control" id="inputNoLPManual" name="no_lp_manual" placeholder="No. LP Manual (opsional)">
          </div>
          <div class="form-group">
            <label for="inputUser">User</label>
            <input type="text" class="form-control" id="inputUser" name="user" placeholder="Nama User" required>
          </div>
        </form>
        <div id="notifPulangkanPasien"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Tutup</button>
        <button type="button" class="btn btn-primary" id="submitPulangkanPasien">Update Tanggal Pulang</button>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  $('select').selectator();
  // ketika inputbox pencarian no rm/nama pasien diisi
  $('input:text[name=pasien]').on('keydown',function(e){
    var baseURL = mlite.url + '/' + mlite.admin;
    if(event.which==13){
    var url    = baseURL + '/rawat_inap/pasien?t=' + mlite.token;
    var cari = $('input:text[name=pasien]').val();

    if(cari!="") {
        $.post(url, {cari: cari} ,function(data) {
        // tampilkan data yang sudah di perbaharui
          $("#pasien").html(data).show();
        });
    }
    else {
        $("#pasien").hide();
    }
    }
  });
  // ketika baris data diklik
  $("#pasien").on("click", ".pilih", function(event){
    var baseURL = mlite.url + '/' + mlite.admin;
    event.preventDefault();

    var no_rkm_medis		   = $(this).attr("data-no_rkm_medis");
    var nm_pasien    = $(this).attr("data-nm_pasien");
    var no_rawat      = $(this).attr("data-no_rawat");

    var url    				= baseURL + '/rawat_inap/statusdaftar?t=' + mlite.token;

    $.post(url, {no_rkm_medis: no_rkm_medis} ,function(data) {
      $("#stts_daftar").html(data).show();
    });
    var stts_daftar = $('input:text[name=stts_daftar]').val();

    $('input:text[name=no_rkm_medis]').val(no_rkm_medis);
    $('input:text[name=nm_pasien]').val(nm_pasien);
    $('input:text[name=no_rawat]').val(no_rawat);

    $("#pasien").hide();

  });
</script>
<script type="text/javascript">
   $(function () {
       $('.tanggal_jam').datetimepicker({
         format: 'YYYY-MM-DD HH:mm:ss',
         locale: 'id'
       });
   });
   $(function () {
       $('.tanggal').datetimepicker({
         format: 'YYYY-MM-DD',
         locale: 'id'
       });
   });
   $(function () {
       $('.jam').datetimepicker({
         format: 'HH:mm:ss',
         locale: 'id'
       });
   });
</script>
